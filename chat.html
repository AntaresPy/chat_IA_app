<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Chat</title>
  <meta
    http-equiv="Content-Security-Policy"
    content="
      default-src 'self';
      script-src 'self';
      style-src 'self';
      img-src 'self' data:;
      connect-src 'self';
      object-src 'none';
      base-uri 'self';
    "
  />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./style.chat.css" />
</head>
<body>
  <div class="layout">
    <!-- Barra de navegación superior -->
    <header class="topbar">
      <h2 id="tituloSesion" class="topbar__title" title="Título de la conversación">Chat</h2>
    </header>

    <!-- Columna scroleable -->
    <main class="contenido">
      <div class="help" id="help">
        <button id="btnVolver" class="nav-btn">←</button>
        <div class="topbar__spacer"></div>
        <label class="model-select" title="Modelo de IA a usar en esta sesión">
          <span>Modelo</span>
          <select id="selectModelo">
            <option value="deepseek-chat">Estándar</option>
            <option value="deepseek-r1">R1 (razonamiento)</option>
          </select>
        </label>
        <button id="btnDescargar" class="nav-btn">Descargar</button>
      </div>

      <div id="historial" class="historial"></div>

      <div class="entrada">
        <textarea id="txt" rows="1" placeholder="Escribí tu mensaje..."></textarea>
        <button id="btnEnviar">Enviar</button>
      </div>
    </main>
  </div>

  <!-- Modal de descarga -->
  <div id="modalDescarga" class="modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal__backdrop" data-close="true"></div>
    <div class="modal__dialog" role="document">
      <div class="modal__header">
        <h3 id="modalTitle">Exportar conversación</h3>
        <button class="modal__close" id="btnCerrarModalDesc" aria-label="Cerrar">✕</button>
      </div>
      <div class="modal__body">
        <fieldset class="field">
          <legend>Formato</legend>
          <label class="row">
            <input type="radio" name="fmt" value="txt" checked />
            <span>Texto (.txt)</span>
          </label>
          <label class="row">
            <input type="radio" name="fmt" value="json" />
            <span>JSON (.json)</span>
          </label>
        </fieldset>

        <label class="row">
          <input type="checkbox" id="chkMeta" checked />
          <span>Incluir metadatos (título, modelo, fecha)</span>
        </label>
      </div>
      <div class="modal__footer">
        <button id="btnCancelarDesc" class="ghost">Cancelar</button>
        <button id="btnConfirmarDesc" class="primary">Descargar</button>
      </div>
    </div>
  </div>

  <script defer src="./chat.js"></script>
</body>
</html>
